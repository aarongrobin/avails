<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avails</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <h1 class="logo">Avails</h1>
      <div class="header-tz">
        <span class="tz-section-label">My Timezone</span>
        <div class="my-tz-dropdown-wrapper">
          <div id="my-tz-multi-select" class="my-tz-multi-select">
            <span id="my-timezone-display" class="my-tz-display">Loading...</span>
            <input
              type="text"
              id="my-tz-search-input"
              class="my-tz-search-input"
              placeholder=""
              autocomplete="off"
            >
            <span class="my-tz-arrow">▼</span>
          </div>
          <div id="my-tz-dropdown-list" class="my-tz-dropdown-list hidden"></div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main">
      <!-- Date Range Selector -->
      <div class="segment-control">
        <button id="btn-5-days" class="segment-btn active" data-days="5">Next 5 Days</button>
        <button id="btn-10-days" class="segment-btn" data-days="10">Next 10 Days</button>
        <button id="btn-custom" class="segment-btn">Custom</button>
      </div>

      <!-- Custom Date Range Panel -->
      <div id="custom-panel" class="custom-panel hidden">
        <div class="date-picker-row">
          <div class="date-field">
            <label>Start Date</label>
            <div class="date-input-wrapper">
              <div id="start-date-display" class="date-input-display">
                <span class="date-placeholder">Select start date</span>
                <span class="date-icon">▼</span>
              </div>
              <div id="start-date-calendar" class="calendar-dropdown hidden">
                <!-- Calendar generated by JS -->
              </div>
            </div>
          </div>
          <div class="date-field">
            <label>End Date</label>
            <div class="date-input-wrapper">
              <div id="end-date-display" class="date-input-display">
                <span class="date-placeholder">Select end date</span>
                <span class="date-icon">▼</span>
              </div>
              <div id="end-date-calendar" class="calendar-dropdown hidden">
                <!-- Calendar generated by JS -->
              </div>
            </div>
          </div>
        </div>
        <div id="custom-error" class="custom-error hidden"></div>
      </div>

      <!-- Helper Text -->
      <p class="helper-text">Enter times like: 10-11 AM, 2-3 PM, 1PM, noon-1</p>

      <!-- Date Input Rows -->
      <div id="date-rows" class="date-rows">
        <!-- Generated by JS -->
      </div>

      <!-- Clear Times Button -->
      <div id="clear-times-section" class="clear-times-section">
        <button id="clear-times-btn" class="clear-times-btn">Clear Times</button>
        <div id="clear-times-popup" class="clear-times-popup hidden">
          <p class="clear-popup-text">Do you want to clear all times entered?</p>
          <div class="clear-popup-buttons">
            <button id="clear-confirm-yes" class="clear-popup-btn clear-yes">Yes</button>
            <button id="clear-confirm-no" class="clear-popup-btn clear-no">No</button>
          </div>
        </div>
      </div>

      <!-- Validation Messages (legacy, now using inline) -->
      <div id="validation-messages" class="validation-messages hidden"></div>

      <!-- Additional Timezones Section -->
      <div class="additional-tz-section">
        <div class="tz-section-header">
          <span class="tz-section-label">Additional Timezones</span>
          <button type="button" id="edit-favorites-btn" class="edit-favorites-btn">Edit</button>
        </div>

        <!-- Favorites and Search in one row -->
        <div class="favorites-row">
          <div id="favorite-chips" class="favorite-chips">
            <!-- Generated by JS -->
          </div>
          <div class="tz-dropdown-wrapper">
            <div id="tz-multi-select" class="tz-multi-select">
              <div id="tz-selected-tags" class="tz-selected-tags"></div>
              <input
                type="text"
                id="tz-search-input"
                class="tz-search-input"
                placeholder="Add timezone..."
                autocomplete="off"
              >
            </div>
            <div id="tz-dropdown-list" class="tz-dropdown-list hidden"></div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Actions -->
    <footer class="footer">
      <button id="btn-generate" class="btn btn-generate" disabled>
        <span class="btn-text">Generate Schedule</span>
        <span id="generate-feedback" class="btn-feedback">Generated!</span>
      </button>

      <!-- Output Section -->
      <div id="output-section" class="output-section hidden">
        <div id="output-preview" class="output-preview"></div>
        <button id="btn-copy" class="btn btn-copy">
          <span class="btn-text">Copy Schedule</span>
          <span id="copy-feedback" class="btn-feedback">Copied!</span>
        </button>
      </div>

      <!-- Status Message (for errors only) -->
      <div id="status-message" class="status-toast hidden"></div>
    </footer>
  </div>

  <!-- Favorites Editor Modal -->
  <div id="favorites-editor" class="timezone-editor-overlay hidden">
    <div class="timezone-editor-modal">
      <div class="timezone-editor-header">
        <h2>Edit Favorite Timezones</h2>
        <button type="button" id="close-favorites-editor" class="timezone-editor-close">&times;</button>
      </div>
      <div class="timezone-editor-search">
        <input
          type="text"
          id="favorites-search-input"
          class="timezone-search-input"
          placeholder="Search by city or timezone..."
          autocomplete="off"
        >
      </div>
      <p class="timezone-editor-hint">Click the star to add or remove favorites (max 3)</p>
      <div id="favorites-editor-list" class="timezone-editor-list">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../js/dateGenerator.js"></script>
  <script src="../js/timeParser.js"></script>
  <script src="../js/timezoneManager.js"></script>
  <script src="../js/storageManager.js"></script>
  <script src="../js/outputFormatter.js"></script>
  <script src="sidepanel.js"></script>
</body>
</html>
